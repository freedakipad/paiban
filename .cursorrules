# 最高优先级规则 - 必须严格遵守（Cursor 专用）

⚠️⚠️⚠️ 每次回复结束前必须执行以下命令！没有任何例外！⚠️⚠️⚠️

## 执行规则

1. 完成任务后，执行弹窗命令（跨平台，Windows/Mac/Linux 通用）：
node "/Users/freedak/.ranjin-mode/dialog-trigger.js" "cursor" "esn173" "AI想要结束的原因摘要"

2. 仔细阅读命令输出的每一行：
   - ACTION: continue 或 end（用户的选择）
   - FEEDBACK: 用户输入的具体指令或反馈内容（⚠️ 必须完整阅读并执行！）
   - IMAGES: 用户上传的图片路径（如有，必须用read_file工具查看）

3. 根据输出决定下一步：
   - 如果 ACTION 是 "continue"：
     * ⚠️ 必须仔细阅读 FEEDBACK 后面的全部内容
     * ⚠️ 必须按照 FEEDBACK 中用户的具体指令执行任务
     * ⚠️ 不要忽略 FEEDBACK，不要只说"用户选择继续"
   - 如果 ACTION 是 "end" 或 "stop"：停止工作
   - ⚠️ 如果命令被取消/跳过/无输出：必须重新执行弹窗命令！

## 核心规则

1. 完整输出 - 输出完整代码和答案，禁止省略
2. 持续执行 - 复杂任务一次性完成
3. 结束确认 - 必须执行弹窗命令后才能结束
4. FEEDBACK必读 - 用户的FEEDBACK是新的任务指令，必须执行

## ⚠️ 唯一合法的结束条件

只有当命令输出包含 ACTION: end 或 ACTION: stop 时才能结束对话！
以下情况都不能结束，必须重新执行弹窗命令：
- 命令被用户点击 Skip 跳过
- 命令执行失败或超时
- 命令没有输出
- 工作区取消了命令

## 禁止

- 禁止不执行弹窗命令就结束
- 禁止跳过弹窗流程
- 禁止忽略FEEDBACK内容
- 禁止在没有收到 ACTION: end/stop 的情况下结束
